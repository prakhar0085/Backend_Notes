                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   Stateful Authentication Backend System      â”‚
                         â”‚     (Node.js + Express + MongoDB + Sessions)  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                         â”‚
                                         â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚      Client (Frontend)    â”‚
                            â”‚  (Postman / React App)    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                              HTTP Requests (JSON)
                                          â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚           index.js              â”‚
                         â”‚   (Main server entry point)     â”‚
                         â”‚   - Loads env vars (.env)       â”‚
                         â”‚   - Connects to MongoDB         â”‚
                         â”‚   - Configures express-session  â”‚
                         â”‚   - Registers Routes            â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   /api/user Routes â”‚                       â”‚   /api/task Routes â”‚
         â”‚ (user.routes.js)   â”‚                       â”‚ (task.routes.js)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ user.controller.js     â”‚                 â”‚ task.controller.js    â”‚
        â”‚ - signup()             â”‚                 â”‚ - addTask()           â”‚
        â”‚ - login()              â”‚                 â”‚ - fetchTasks()        â”‚
        â”‚ - logout() (optional)  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
                  â”‚                                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ user.service.js        â”‚                 â”‚ task.service.js       â”‚
        â”‚ - registerUser()       â”‚                 â”‚ - createTask()        â”‚
        â”‚ - loginUser()          â”‚                 â”‚ - getTasks()          â”‚
        â”‚ - handle bcrypt + DB   â”‚                 â”‚ - DB interaction      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ user.model.js          â”‚                 â”‚ task.model.js         â”‚
        â”‚ - username, password   â”‚                 â”‚ - userId, title, desc â”‚
        â”‚ - bcrypt hashed pw     â”‚                 â”‚ - timestamps          â”‚
        â”‚ - Mongoose schema      â”‚                 â”‚ - Mongoose schema     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                           â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º MongoDB â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          (Database storing Users & Tasks)
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   Database: task (MongoDB)   â”‚
                          â”‚   Collections:               â”‚
                          â”‚   - users                    â”‚
                          â”‚   - tasks                    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        ğŸ” SESSION MANAGEMENT (Stateful Authentication)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ express-session middleware â”‚
                           â”‚ (Configured in index.js)   â”‚
                           â”‚                           â”‚
                           â”‚ - Uses SESSION_SECRET      â”‚
                           â”‚ - Cookie expires in 10 min â”‚
                           â”‚ - Stores userId in session â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                              Session Cookie Flow
                                       â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                â”‚                                â”‚
      â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
      â”‚                        â”‚ validateSession â”‚                      â”‚
      â”‚                        â”‚ middleware.js   â”‚                      â”‚
      â”‚                        â”‚ - Checks req.session.userId            â”‚
      â”‚                        â”‚ - If not found â†’ 401 Unauthorized       â”‚
      â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
      â”‚                                 â”‚                               â”‚
      â”‚                         Authenticated requests only             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                            Only authenticated users can:
                            - Create tasks
                            - View their own tasks
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš™ï¸ CONFIGURATION & SECURITY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ .env               â”‚      â”‚ config/db.js              â”‚
â”‚ - PORT             â”‚      â”‚ - Connects to MongoDB     â”‚
â”‚ - MONGO_URI        â”‚      â”‚ - Uses Mongoose           â”‚
â”‚ - SESSION_SECRET   â”‚      â”‚ - Handles connection logs â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”’ Security:
- Passwords hashed with bcrypt (saltRounds = 10)
- No JWTs (stateful sessions instead)
- Username uniqueness enforced by Mongoose
- Proper error handling in controllers/services
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


ğŸ“Š DATA FLOW EXAMPLE (Step-by-step)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1ï¸âƒ£ Signup:
Client â†’ POST /api/user/signup  
â†’ userController.signup()  
â†’ userService.registerUser()  
â†’ bcrypt.hash(password)  
â†’ User.save() â†’ MongoDB  

2ï¸âƒ£ Login:
Client â†’ POST /api/user/login  
â†’ userController.login()  
â†’ userService.loginUser()  
â†’ bcrypt.compare()  
â†’ if success â†’ req.session.userId = user._id  
â†’ sends cookie to client  

3ï¸âƒ£ Create Task:
Client (with cookie) â†’ POST /api/task/  
â†’ validateSession middleware  
â†’ taskController.addTask()  
â†’ taskService.createTask()  
â†’ Task.save() (userId attached from session)  

4ï¸âƒ£ Fetch Tasks:
Client (with cookie) â†’ GET /api/task/  
â†’ validateSession middleware  
â†’ taskController.fetchTasks()  
â†’ taskService.getTasks()  
â†’ Task.find({ userId: req.session.userId })  

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Summary:

index.js initializes everything (session, DB, routes).

Routes forward requests to controllers.

Controllers handle HTTP logic & call services.

Services handle business logic + DB operations.

Models define MongoDB schema (User, Task).

Session middleware ensures authenticated access to tasks.

Session data (userId) is stored server-side â€” stateful authentication.



What Is Session Management?

Session management is how a server keeps track of which client (user) is currently logged in â€” across multiple requests.

In HTTP, each request is stateless â€” meaning:

Every new request is independent; the server doesnâ€™t automatically remember who you are.

To solve that, stateful session authentication uses sessions stored on the server â€” so the server can remember you between requests.

ğŸ”’ Stateful Authentication: Concept Overview

In stateful authentication, after a successful login:

The server creates a session for the user.

The session data (e.g., userId) is stored in memory or a database on the server.

The server sends back a session ID to the client â€” inside a cookie.

On every future request, the client automatically sends that cookie back.

The server looks up the session ID â†’ retrieves the stored user info â†’ identifies the user.

So the â€œstateâ€ (who is logged in) lives on the server â€” thatâ€™s why itâ€™s called stateful.

âš™ï¸ How It Works in Your Project
1ï¸âƒ£ Login Flow

Route: POST /api/user/login

Flow:

Client â†’ Server (username, password)
Server â†’ Verifies credentials
        â†’ Creates a session object
        â†’ Stores session in server memory
        â†’ Attaches sessionId to a cookie
Client â† Receives cookie


Example:

req.session.userId = user._id;


This line stores the userâ€™s ID in their session.

2ï¸âƒ£ Session Cookie

Once logged in, the server gives the client a session cookie like:

connect.sid = s%3AA7d3x....abcd


This cookie is stored automatically by the browser or Postman.

It gets sent automatically with every new request to the same server.

So when the user sends another request (like creating a task), the server knows who it is based on that cookie.

3ï¸âƒ£ Session Validation Middleware

File: middlewares/session.middleware.js

This middleware protects private routes (like /api/task):

export const validateSession = (req, res, next) => {
  if (!req.session.userId) {
    return res.status(401).json({ message: 'Unauthorized: Please log in' });
  }
  next();
};


âœ… If req.session.userId exists â†’ user is logged in
âŒ If not â†’ request is rejected

4ï¸âƒ£ Session Expiration

In your configuration, sessions expire after 10 minutes of inactivity:

app.use(session({
  secret: process.env.SESSION_SECRET,
  resave: false,
  saveUninitialized: false,
  cookie: { maxAge: 10 * 60 * 1000 } // 10 minutes
}));


After that time, the session data is deleted, and the user must log in again.

5ï¸âƒ£ Logout Flow

When a user logs out, their session is destroyed:

req.session.destroy((err) => {
  if (err) return res.status(500).json({ message: 'Logout failed' });
  res.clearCookie('connect.sid');
  res.json({ message: 'Logged out successfully' });
});


That means:

The session data is removed from the server.

The session cookie on the client becomes useless.


Comparison: Stateful vs Stateless (JWT)
Feature	Stateful (Sessions)	Stateless (JWT)
Where is session stored?	On the server	On the client (token)
Scalability	Harder (server must store sessions)	Easier (no server memory)
Security	More secure (session invalidates easily)	Must handle token expiration manually
Logout	Easy â€” just delete session	Harder â€” must blacklist token
Common use	Web apps (Express, Django)	APIs, mobile apps
âœ… Summary
Step	Description
1. Login	Server authenticates and creates session
2. Session Storage	express-session keeps session in memory
3. Cookie	Client stores session ID
4. Middleware	Validates req.session.userId on each request
5. Expiry	Session auto-expires after 10 minutes
6. Logout	Session destroyed â†’ user logged out


              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ 1ï¸âƒ£ User Logs In           â”‚
              â”‚  â†’ Server verifies user    â”‚
              â”‚  â†’ Creates session         â”‚
              â”‚  â†’ Sends cookie            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ 2ï¸âƒ£ Cookie Stored on Clientâ”‚
              â”‚  â†’ Sent automatically      â”‚
              â”‚    with next requests      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ 3ï¸âƒ£ Middleware Checks      â”‚
              â”‚  â†’ req.session.userId?     â”‚
              â”‚  â†’ YES â†’ allow request     â”‚
              â”‚  â†’ NO  â†’ 401 Unauthorized  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ 4ï¸âƒ£ Session Expires or      â”‚
              â”‚     User Logs Out          â”‚
              â”‚  â†’ Session destroyed       â”‚
              â”‚  â†’ Cookie cleared          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜




ğŸª What Are Cookies?

Cookies are small pieces of data that a server stores on a clientâ€™s browser to remember information between requests.

You can think of them like a â€œmemory cardâ€ for the web â€” they help the server recognize who the client is when the client makes another request.

ğŸŒ Why Cookies Exist

HTTP (the web protocol) is stateless â€”
meaning every new request is treated as if it comes from a brand-new user.

The server doesnâ€™t automatically remember you â€” even if you just logged in 2 seconds ago.

Cookies fix this by storing small bits of information on the client side (like a session ID, theme preference, or shopping cart).

âš™ï¸ How Cookies Work (Step-by-Step)

Letâ€™s use your Stateful Authentication backend as an example:

ğŸ§© Step 1 â€” Client Logs In

You send credentials:

POST /api/user/login
{ "username": "prakhar", "password": "1234" }


The server checks the credentials.

On success, it creates a session (with your userId) and sends back a cookie like this:

Set-Cookie: connect.sid=s%3Aabc123xyz; Path=/; HttpOnly

ğŸ§© Step 2 â€” Browser Stores Cookie

The browser (or Postman) automatically saves this cookie.

You donâ€™t need to manually handle it.

ğŸ§© Step 3 â€” Client Sends Cookie Automatically

On every next request (like fetching tasks):

GET /api/task


The browser automatically adds:

Cookie: connect.sid=s%3Aabc123xyz


The server checks this session ID â†’ finds it in memory â†’ identifies you as â€œPrakharâ€.

âœ… Youâ€™re authenticated without sending your password again!

ğŸ’¡ Example Visualization
Client (Browser)
    |
    |-- POST /login --> [Server verifies credentials]
    |
    |<-- Set-Cookie: connect.sid=abc123  (Server sends cookie)
    |
    |-- GET /api/task
    |   Cookie: connect.sid=abc123  (Browser sends cookie automatically)
    |
    |<-- Server finds session "abc123" = userId: 1, returns tasks

ğŸ§  Whatâ€™s Inside a Cookie?

A cookie is just a key-value pair, with extra properties.

Example:

connect.sid=s%3Aabc123xyz; Path=/; HttpOnly; Max-Age=600

Property	Meaning
connect.sid	Cookie name (your session ID)
s%3Aabc123xyz	Encrypted value
Path=/	Cookie is sent for all paths in the site
HttpOnly	Canâ€™t be accessed by JavaScript (prevents XSS attacks)
Max-Age=600	Expires after 600 seconds (10 minutes)
ğŸ”’ Cookie Security Options

When configuring express-session, you can define cookie behavior:

app.use(session({
  secret: process.env.SESSION_SECRET,
  resave: false,
  saveUninitialized: false,
  cookie: {
    maxAge: 10 * 60 * 1000,   // 10 minutes
    httpOnly: true,           // prevents JS access
    secure: false,            // true = HTTPS only
  }
}));

Option	Description
maxAge	How long cookie lives (in milliseconds)
httpOnly	Stops JS from reading it (reduces hacking risk)
secure	Sends cookie only over HTTPS (for production)
ğŸ“¦ Cookie Storage Limits

Each cookie is about 4KB max in size.

Each domain can store around 20 cookies.

They are automatically managed by browsers.

ğŸ“Š Cookies vs Other Storage
Feature	Cookie	Local Storage	Session Storage
Sent to server automatically	âœ… Yes	âŒ No	âŒ No
Good for authentication	âœ… Yes (session ID)	âš ï¸ Risky	âš ï¸ Risky
Persistent after closing browser	âœ… (if not expired)	âœ…	âŒ
Accessed by JavaScript	âŒ if HttpOnly	âœ…	âœ…
âœ… Summary
Concept	Explanation
What	Small data stored in browser
Purpose	Let server remember user between requests
Used for	Login sessions, preferences, tracking
In your project	Stores session ID created by express-session
Automatically handled by	Browser or Postman
Security	Controlled using httpOnly, secure, and expiration time
ğŸ§© In short:

ğŸ”¹ Cookie = ID card the browser carries
ğŸ”¹ Session = Record in the serverâ€™s database/memory
ğŸ”¹ Together, they make stateful authentication possible âœ…